---
import '~/assets/styles/tailwind.css';
import Favicons from '~/components/Favicons.astro';
import CustomStyles from '~/components/CustomStyles.astro';
import ApplyColorMode from '~/components/common/ApplyColorMode.astro';
import BasicScripts from '~/components/common/BasicScripts.astro';

import Analytics from '~/components/common/Analytics.astro';
import CommonMeta from '~/components/common/CommonMeta.astro';
import Metadata from '~/components/common/Metadata.astro';
import Loading from '~/components/widgets/Loading.astro';

import {I18N} from '~/utils/config';

import type {MetaData as MetaDataType} from '~/types';
export interface Props {
    metadata?: MetaDataType;
}

const {metadata = {}} = Astro.props;

const {language, textDirection} = I18N;
// import {findImage} from '~/utils/images';
// const image = (await findImage('~/assets/images/default.jpg')) as ImageMetadata | undefined;
// const posts = await Astro.glob('~/assets/images/**/*');
---

<!doctype html>
<html lang={language} dir={textDirection} class='2xl:text-[20px]'>
    <head>
        <CommonMeta />
        <Favicons />
        <CustomStyles />
        <ApplyColorMode />
        <Analytics />
        <Metadata {...metadata} />

        <!-- Uncomment line below to activate View Transitions -->
        <!-- <ViewTransitions fallback="swap" /> -->
    </head>

    <body class='antialiased text-default bg-page tracking-tight'>
        <!-- {
            !image ? null : (
                <div class='shareimg'>
                    <img src={image.src} />
                </div>
            )
        } -->
        <Loading />
        <slot />

        <BasicScripts />
        <style is:global>
            .shareimg {
                display: none;
            }
            img {
                content-visibility: auto;
            }
        </style>
    </body>
</html>
